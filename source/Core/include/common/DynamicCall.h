#pragma once

#include <common/base_types.h>
#include <common/ntdll.h>



#define MAX_API_TABLE 700

#define API_STRING_(X) X
#define API(dll, api)		::api
#define API_KERNEL32(api)	API(KERNEL32,	api)
#define API_SHLOBJ(api)		API(SHLOBJ,		api)
#define API_SHLWAPI(api)	API(SHLWAPI,	api)
#define API_OLE32(api)		API(OLE32,		api)
#define API_OLEAUT32(api)	API(OLE_AUT32,	api) // for xml.h

#define KERNERL32_MODULE_HASH  0x4B1FFE8E



#define MAX_API_TABLE 700


enum
{
	KERNEL32 = 0,
	NTDLL,
	USER32,
	SHLWAPI,
	URLMON,
	WINHTTP,
	WS2_32,

	IPHLPAPI,
	SHELL32,
	CRYPT32,

	ADVAPI32,
	GDIPLUS,
	GDI32,
	OLE32,
	OLE_AUT32,
	PSAPI,
	CABINET,
	IMAGEHLP,
	NETAPI32,
	WTSAPI32,
	MPR,
	LAST_MODULE
};

namespace details
{
	const static char KERNEL32_DLL[] = "kernel32.dll";
	const static char NTDLL_DLL[] = "ntdll.dll";
	const static char USER32_DLL[] = "user32.dll";
	const static char SHLWAPI_DLL[] = "shlwapi.dll";
	const static char URLMON_DLL[] = "urlmon.dll";
	const static char WINHTTP_DLL[] = "winhttp.dll";
	const static char WS2_32_DLL[] = "ws2_32.dll";
	const static char SHELL32_DLL[] = "shell32.dll";
}

typedef struct API_CALL_CACHE
{
	int count;
	unsigned long func_hash_table[MAX_API_TABLE];
	void* func_addr_table[MAX_API_TABLE];
	HMODULE handle_hmodule[LAST_MODULE - 1];

}API_CALL_CACHE, *LP_API_CALL_CACHE;



namespace DynamicCall
{

	bool Initialize();
	PPEB GetPEB();
	const char*  GetModuleNameString(DWORD ID);
	HMODULE GetDllBase(DWORD hash);
	HMODULE GetKernel32();
	void* GetAdressOfAPI(HMODULE hModule, DWORD dwProcHash);
	void* GetProcAddressEx(DWORD dwModule, DWORD dwProcHash);

	bool BuildImportTable(HMODULE imageBase, tLoadLibraryA _LoadLibraryA, tGetProcAddress _GetProcAddress);
	bool InitializeImportsTable();
}


template <typename return_t, DWORD module_id, DWORD hash>
inline return_t stdcall_args()
{
	typedef return_t(WINAPI *newfunc)();
	newfunc func = newfunc(DynamicCall::GetProcAddressEx(module_id, hash));
	return func();
}


template <typename return_t, DWORD module_id, DWORD hash, class A>
inline return_t stdcall_args(A a1)
{
	typedef return_t(WINAPI *newfunc)(A);
	newfunc func = newfunc(DynamicCall::GetProcAddressEx(module_id, hash));
	return func(a1);
}

template <typename return_t, DWORD module_id, DWORD hash, class A, class B>
inline return_t stdcall_args(A a1, B a2)
{
	typedef return_t(WINAPI *newfunc)(A, B);
	newfunc func = newfunc(DynamicCall::GetProcAddressEx(module_id, hash));;
	return func(a1, a2);
}

template <typename return_t, DWORD module_id, DWORD hash, class A, class B, class C>
inline return_t stdcall_args(A a1, B a2, C a3)
{
	typedef return_t(WINAPI *newfunc)(A, B, C);
	newfunc func = newfunc(DynamicCall::GetProcAddressEx(module_id, hash));;
	return func(a1, a2, a3);
}

template <typename return_t, DWORD module_id, DWORD hash, class A, class B, class C, class D>
inline return_t stdcall_args(A a1, B a2, C a3, D a4)
{
	typedef return_t(WINAPI *newfunc)(A, B, C, D);
	newfunc func = newfunc(DynamicCall::GetProcAddressEx(module_id, hash));;
	return func(a1, a2, a3, a4);
}

template <typename return_t, DWORD module_id, DWORD hash, class A, class B, class C, class D, class E>
inline return_t stdcall_args(A a1, B a2, C a3, D a4, E a5)
{
	typedef return_t(WINAPI *newfunc)(A, B, C, D, E);
	newfunc func = newfunc(DynamicCall::GetProcAddressEx(module_id, hash));;
	return func(a1, a2, a3, a4, a5);
}

template <typename return_t, DWORD module_id, DWORD hash, class A, class B, class C, class D, class E, class F>
inline return_t stdcall_args(A a1, B a2, C a3, D a4, E a5, F a6)
{
	typedef return_t(WINAPI *newfunc)(A, B, C, D, E, F);
	newfunc func = newfunc(DynamicCall::GetProcAddressEx(module_id, hash));;
	return func(a1, a2, a3, a4, a5, a6);
}

template <typename return_t, DWORD module_id, DWORD hash, class A, class B, class C, class D, class E, class F, class G>
inline return_t stdcall_args(A a1, B a2, C a3, D a4, E a5, F a6, G a7)
{
	typedef return_t(WINAPI *newfunc)(A, B, C, D, E, F, G);
	newfunc func = newfunc(DynamicCall::GetProcAddressEx(module_id, hash));;
	return func(a1, a2, a3, a4, a5, a6, a7);
}

template <typename return_t, DWORD module_id, DWORD hash, class A, class B, class C, class D, class E, class F, class G, class H>
inline return_t stdcall_args(A a1, B a2, C a3, D a4, E a5, F a6, G a7, H a8)
{
	typedef return_t(WINAPI *newfunc)(A, B, C, D, E, F, G, H);
	newfunc func = newfunc(DynamicCall::GetProcAddressEx(module_id, hash));;
	return func(a1, a2, a3, a4, a5, a6, a7, a8);
}

template <typename return_t, DWORD module_id, DWORD hash, class A, class B, class C, class D, class E, class F, class G, class H, class I>
inline return_t stdcall_args(A a1, B a2, C a3, D a4, E a5, F a6, G a7, H a8, I a9)
{
	typedef return_t(WINAPI *newfunc)(A, B, C, D, E, F, G, H, I);
	newfunc func = newfunc(DynamicCall::GetProcAddressEx(module_id hash));;
	return func(a1, a2, a3, a4, a5, a6, a7, a8, a9);
}

template <typename return_t, DWORD module_id, DWORD hash, class A, class B, class C, class D, class E, class F, class G, class H, class I, class X>
inline return_t stdcall_args(A a1, B a2, C a3, D a4, E a5, F a6, G a7, H a8, I a9, X a10)
{
	typedef return_t(WINAPI *newfunc)(A, B, C, D, E, F, G, H, I, X);
	newfunc func = newfunc(DynamicCall::GetProcAddressEx(module_id, hash));;
	return func(a1, a2, a3, a4, a5, a6, a7, a8, a9, a10);
}

template <typename return_t, DWORD module_id, DWORD hash, class A, class B, class C, class D, class E, class F, class G, class H, class I, class X, class Y>
inline return_t stdcall_args(A a1, B a2, C a3, D a4, E a5, F a6, G a7, H a8, I a9, X a10, Y a11)
{
	typedef return_t(WINAPI *newfunc)(A, B, C, D, E, F, G, H, I, X, Y);
	newfunc func = newfunc(DynamicCall::GetProcAddressEx(module_id, hash));;
	return func(a1, a2, a3, a4, a5, a6, a7, a8, a9, a10, a11);
}

template <typename return_t, DWORD module_id, DWORD hash, class A, class B, class C, class D, class E, class F, class G, class H, class I, class X, class Y, class Z, class R>
inline return_t stdcall_args(A a1, B a2, C a3, D a4, E a5, F a6, G a7, H a8, I a9, X a10, Y a11, Z a12, R a13)
{
	typedef return_t(WINAPI *newfunc)(A, B, C, D, E, F, G, H, I, X, Y, Z, R);
	newfunc func = newfunc(DynamicCall::GetProcAddressEx(module_id, hash));;
	return func(a1, a2, a3, a4, a5, a6, a7, a8, a9, a10, a11, a12, a13);
}

template <typename return_t, DWORD module_id, DWORD hash, class A1, class A2, class A3, class A4, class A5, class A6, class A7, class A8, class A9, class A10, class A11, class A12>
inline return_t stdcall_args(A1 a1, A2 a2, A3 a3, A4 a4, A5 a5, A6 a6, A7 a7, A8 a8, A9 a9, A10 a10, A11 a11, A12 a12)
{
	typedef return_t(WINAPI *newfunc)(A1, A2, A3, A4, A5, A6, A7, A8, A9, A10, A11, A12);
	newfunc func = newfunc(DynamicCall::GetProcAddressEx(module_id, hash));
	return func(a1, a2, a3, a4, a5, a6, a7, a8, a9, a10, a11, a12);


}

////////////////////
//shell32
////////////////////

//#define fpAssocCreateForClasses                stdcall_args< long , SHELL32 ,0xA860FD41 >
//#define fpAssocGetDetailsOfPropKey             stdcall_args< long , SHELL32 ,0xAAA8FF33 >
//#define fpCDefFolderMenu_Create2               stdcall_args< long , SHELL32 ,0xA7D81179 >
//#define fpCIDLData_CreateFromIDArray           stdcall_args< long , SHELL32 ,0x230F15E2 >
//#define fpCommandLineToArgvW					stdcall_args< wchar, SHELL32 ,0xDF91E0A8 >
//#define fpDAD_AutoScroll               stdcall_args< int , SHELL32 ,0xEFAADF10 >
//#define fpDAD_DragEnterEx              stdcall_args< int , SHELL32 ,0x213845A4 >
//#define fpDAD_DragEnterEx2             stdcall_args< int , SHELL32 ,0x9C22D222 >
//#define fpDAD_DragLeave                stdcall_args< int , SHELL32 ,0x0C15CD76 >
//#define fpDAD_DragMove                 stdcall_args< int , SHELL32 ,0x263AA009 >
//#define fpDAD_SetDragImage             stdcall_args< int , SHELL32 ,0xFCA704A5 >
//#define fpDAD_ShowDragImage            stdcall_args< int , SHELL32 ,0xA4246C30 >
//#define fpDllCanUnloadNow              stdcall_args< long , SHELL32 ,0x2F867DED >
//#define fpDllGetClassObject            stdcall_args< long , SHELL32 ,0x72A4F6CE >
//#define fpDllInstall           stdcall_args< long , SHELL32 ,0x52415139 >
//#define fpDoEnvironmentSubstA                  stdcall_args< unsigned long , SHELL32 ,0xC1690EA2 >
//#define fpDoEnvironmentSubstW                  stdcall_args< unsigned long , SHELL32 ,0xC1690EB4 >
//#define fpDragAcceptFiles              stdcall_args< void , SHELL32 ,0x18EC0035 >
//#define fpDragFinish           stdcall_args< void , SHELL32 ,0xEF19E7FC >
//#define fpDragQueryFileA               stdcall_args< unsigned int , SHELL32 ,0xBFDCC0E7 >
//#define fpDragQueryFileW               stdcall_args< unsigned int , SHELL32 ,0xBFDCC0F1 >
//#define fpDragQueryPoint               stdcall_args< int , SHELL32 ,0xDF1D8553 >
//#define fpDriveType            stdcall_args< int , SHELL32 ,0x1E7BDFD3 >
//#define fpDuplicateIcon                stdcall_args< struct HICON, SHELL32 ,0x34B1CC7E >
//#define fpExtractAssociatedIconA               stdcall_args< struct HICON, SHELL32 ,0x5063FF0A >
//#define fpExtractAssociatedIconExA             stdcall_args< struct HICON, SHELL32 ,0xFFC3A859 >
//#define fpExtractAssociatedIconExW             stdcall_args< struct HICON, SHELL32 ,0xFFC3A84F >
//#define fpExtractAssociatedIconW               stdcall_args< struct HICON, SHELL32 ,0x5063FF1C >
//#define fpExtractIconA                 stdcall_args< struct HICON, SHELL32 ,0xEEB0C6DF >
//#define fpExtractIconExA               stdcall_args< unsigned int , SHELL32 ,0x31B6C7ED >
//#define fpExtractIconExW               stdcall_args< unsigned int , SHELL32 ,0x31B6C7FB >
//#define fpExtractIconW                 stdcall_args< struct HICON, SHELL32 ,0xEEB0C6C9 >
//#define fpFindExecutableA              stdcall_args< struct HINSTANCE, SHELL32 ,0x37707500 >
//#define fpFindExecutableW              stdcall_args< struct HINSTANCE, SHELL32 ,0x37707516 >
//#define fpGetCurrentProcessExplicitAppUserModelID              stdcall_args< long , SHELL32 ,0x84AA7DBE >
//#define fpGetFileNameFromBrowse                stdcall_args< int , SHELL32 ,0x0A5253BA >
//#define fpILAppendID           stdcall_args< struct , SHELL32 ,0x915AE766 >
//#define fpILClone              stdcall_args< struct , SHELL32 ,0x3D9AD101 >
//#define fpILCloneFirst                 stdcall_args< struct , SHELL32 ,0x81EA31F9 >
//#define fpILCombine            stdcall_args< struct , SHELL32 ,0x95C3781B >
//#define fpILCreateFromPathA            stdcall_args< struct , SHELL32 ,0x5CCD2F11 >
//#define fpILCreateFromPathW            stdcall_args< struct , SHELL32 ,0x5CCD2F07 >
//#define fpILFindChild                  stdcall_args< struct , SHELL32 ,0x7BC9DF26 >
//#define fpILFindLastID                 stdcall_args< struct , SHELL32 ,0x77A98581 >
//#define fpILFree               stdcall_args< void , SHELL32 ,0xC8DCB0A9 >
//#define fpILGetNext            stdcall_args< struct , SHELL32 ,0x0040635B >
//#define fpILGetSize            stdcall_args< unsigned int , SHELL32 ,0x03E3624A >
//#define fpILIsEqual            stdcall_args< int , SHELL32 ,0x17A45770 >
//#define fpILIsParent           stdcall_args< int , SHELL32 ,0xD2CAB9D6 >
//#define fpILLoadFromStreamEx           stdcall_args< long , SHELL32 ,0x9B18F466 >
//#define fpILRemoveLastID               stdcall_args< int , SHELL32 ,0xBD5AEBD6 >
//#define fpILSaveToStream               stdcall_args< long , SHELL32 ,0x673AB60B >
//#define fpInitNetworkAddressControl            stdcall_args< int , SHELL32 ,0x8F7C64EE >
//#define fpIsLFNDriveA                  stdcall_args< int , SHELL32 ,0xE1B09A9F >
//#define fpIsLFNDriveW                  stdcall_args< int , SHELL32 ,0xE1B09A89 >
//#define fpIsNetDrive           stdcall_args< int , SHELL32 ,0xBDC7ECE5 >
//#define fpIsUserAnAdmin                stdcall_args< int , SHELL32 ,0xFDE006E3 >
//#define fpOpenRegStream                stdcall_args< struct IStream * , SHELL32 ,0x186CF705 >
//#define fpPathCleanupSpec              stdcall_args< int , SHELL32 ,0x60F298F9 >
//#define fpPathGetShortPath             stdcall_args< void , SHELL32 ,0xBF419D02 >
//#define fpPathIsExe            stdcall_args< int , SHELL32 ,0xCEB2AF21 >
//#define fpPathIsSlowA                  stdcall_args< int , SHELL32 ,0xC94AC86C >
//#define fpPathIsSlowW                  stdcall_args< int , SHELL32 ,0xC94AC87A >
//#define fpPathMakeUniqueName           stdcall_args< int , SHELL32 ,0xF1772183 >
//#define fpPathQualify                  stdcall_args< void , SHELL32 ,0xE94B20E7 >
//#define fpPathResolve                  stdcall_args< int , SHELL32 ,0xC92A647A >
//#define fpPathYetAnotherMakeUniqueName                 stdcall_args< int , SHELL32 ,0xACA07689 >
//#define fpPickIconDlg                  stdcall_args< int , SHELL32 ,0x1E06054D >
//#define fpPifMgr_CloseProperties               stdcall_args< void * , SHELL32 ,0x4BCFEB68 >
//#define fpPifMgr_GetProperties                 stdcall_args< int , SHELL32 ,0xD374C924 >
//#define fpPifMgr_OpenProperties                stdcall_args< void * , SHELL32 ,0x85ABE233 >
//#define fpPifMgr_SetProperties                 stdcall_args< int , SHELL32 ,0xD234C924 >
//#define fpReadCabinetState             stdcall_args< int , SHELL32 ,0x590D3026 >
//#define fpRealDriveType                stdcall_args< int , SHELL32 ,0x1B5767A5 >
//#define fpRestartDialog                stdcall_args< int , SHELL32 ,0xF8F2593B >
//#define fpRestartDialogEx              stdcall_args< int , SHELL32 ,0x964EDCC4 >
//#define fpSHAddDefaultPropertiesByExt                  stdcall_args< long , SHELL32 ,0x313206C3 >
//#define fpSHAddFromPropSheetExtArray           stdcall_args< unsigned int , SHELL32 ,0x0A370948 >
//#define fpSHAddToRecentDocs            stdcall_args< void , SHELL32 ,0x0B456C6A >
//#define fpSHAlloc              stdcall_args< void * , SHELL32 ,0x1D9A79A7 >
//#define fpSHAppBarMessage              stdcall_args< unsigned int , SHELL32 ,0x1B8359A5 >
//#define fpSHAssocEnumHandlers                  stdcall_args< long , SHELL32 ,0x3A71A264 >
//#define fpSHAssocEnumHandlersForProtocolByApplication                  stdcall_args< long , SHELL32 ,0x3E344DDB >
//#define fpSHBindToFolderIDListParent           stdcall_args< long , SHELL32 ,0x1CA7CF59 >
//#define fpSHBindToFolderIDListParentEx                 stdcall_args< long , SHELL32 ,0xF3D665D1 >
//#define fpSHBindToObject               stdcall_args< long , SHELL32 ,0xD57895FF >
//#define fpSHBindToParent               stdcall_args< long , SHELL32 ,0xE6789387 >
//#define fpSHBrowseForFolderA           stdcall_args< struct , SHELL32 ,0xF5CA9E97 >
//#define fpSHBrowseForFolderW           stdcall_args< struct , SHELL32 ,0xF5CA9E81 >
//#define fpSHCLSIDFromString            stdcall_args< long , SHELL32 ,0x59EF61D5 >
//#define fpSHChangeNotification_Lock            stdcall_args< void * , SHELL32 ,0xBEADE7F5 >
//#define fpSHChangeNotification_Unlock                  stdcall_args< int , SHELL32 ,0x681C5E88 >
//#define fpSHChangeNotify               stdcall_args< void , SHELL32 ,0x8CDD9F3D >
//#define fpSHChangeNotifyDeregister             stdcall_args< int , SHELL32 ,0xCCFF6A8D >
//#define fpSHChangeNotifyRegister               stdcall_args< unsigned long , SHELL32 ,0xA3547853 >
//#define fpSHChangeNotifyRegisterThread                 stdcall_args< void , SHELL32 ,0xDFB83CCF >
//#define fpSHCloneSpecialIDList                 stdcall_args< struct , SHELL32 ,0xAC8B0700 >
//#define fpSHCoCreateInstance           stdcall_args< long , SHELL32 ,0x1F4C35BE >
//#define fpSHCreateAssociationRegistration              stdcall_args< long , SHELL32 ,0x22D799A1 >
//#define fpSHCreateDataObject           stdcall_args< long , SHELL32 ,0x4B66E923 >
//#define fpSHCreateDefaultContextMenu           stdcall_args< long , SHELL32 ,0xA0FC6BDC >
//#define fpSHCreateDefaultExtractIcon           stdcall_args< long , SHELL32 ,0x3A71FA14 >
//#define fpSHCreateDefaultPropertiesOp                  stdcall_args< long , SHELL32 ,0xBA30FC62 >
//#define fpSHCreateDirectory            stdcall_args< int , SHELL32 ,0x6C479E6A >
//#define fpSHCreateDirectoryExA                 stdcall_args< int , SHELL32 ,0xCD5CF4B2 >
//#define fpSHCreateDirectoryExW                 stdcall_args< int , SHELL32 ,0xCD5CF4A4 >
//#define fpSHCreateFileExtractIconW             stdcall_args< long , SHELL32 ,0xD09A6771 >
//#define fpSHCreateItemFromIDList               stdcall_args< long , SHELL32 ,0xC4741531 >
//#define fpSHCreateItemFromParsingName                  stdcall_args< long , SHELL32 ,0xE44CB1EF >
//#define fpSHCreateItemFromRelativeName                 stdcall_args< long , SHELL32 ,0x8181AE12 >
//#define fpSHCreateItemInKnownFolder            stdcall_args< long , SHELL32 ,0xC3B4BC08 >
//#define fpSHCreateItemWithParent               stdcall_args< long , SHELL32 ,0x08810F73 >
//#define fpSHCreateProcessAsUserW               stdcall_args< int , SHELL32 ,0x9ACEE7D2 >
//#define fpSHCreatePropSheetExtArray            stdcall_args< struct HPSXA, SHELL32 ,0x52ACA03C >
//#define fpSHCreateQueryCancelAutoPlayMoniker           stdcall_args< long , SHELL32 ,0x470E269B >
//#define fpSHCreateShellFolderView              stdcall_args< long , SHELL32 ,0x3DEE8FEC >
//#define fpSHCreateShellFolderViewEx            stdcall_args< long , SHELL32 ,0xA3FB2D83 >
//#define fpSHCreateShellItem            stdcall_args< long , SHELL32 ,0x8CE309B6 >
//#define fpSHCreateShellItemArray               stdcall_args< long , SHELL32 ,0x7944FD49 >
//#define fpSHCreateShellItemArrayFromDataObject                 stdcall_args< long , SHELL32 ,0x9E8EF9CF >
//#define fpSHCreateShellItemArrayFromIDLists            stdcall_args< long , SHELL32 ,0x3D4EE2C6 >
//#define fpSHCreateShellItemArrayFromShellItem                  stdcall_args< long , SHELL32 ,0x5548D997 >
//#define fpSHCreateStdEnumFmtEtc                stdcall_args< long , SHELL32 ,0xE424AFB4 >
//#define fpSHDefExtractIconA            stdcall_args< long , SHELL32 ,0xC08357CC >
//#define fpSHDefExtractIconW            stdcall_args< long , SHELL32 ,0xC08357DA >
//#define fpSHDestroyPropSheetExtArray           stdcall_args< void , SHELL32 ,0x048C2942 >
//#define fpSHDoDragDrop                 stdcall_args< long , SHELL32 ,0x171F0EDC >
//#define fpSHEmptyRecycleBinA           stdcall_args< long , SHELL32 ,0x152E4722 >
//#define fpSHEmptyRecycleBinW           stdcall_args< long , SHELL32 ,0x152E4734 >
//#define fpSHEnumerateUnreadMailAccountsW               stdcall_args< long , SHELL32 ,0x3F037AAF >
//#define fpSHEvaluateSystemCommandTemplate              stdcall_args< long , SHELL32 ,0xE79C80D3 >
//#define fpSHFileOperationA             stdcall_args< int , SHELL32 ,0x8B6D020B >
//#define fpSHFileOperationW             stdcall_args< int , SHELL32 ,0x8B6D021D >
//#define fpSHFindFiles                  stdcall_args< int , SHELL32 ,0x2BE89D33 >
//#define fpSHFind_InitMenuPopup                 stdcall_args< struct IContextMenu * , SHELL32 ,0x9FC38CC7 >
//#define fpSHFlushSFCache               stdcall_args< void , SHELL32 ,0x53616169 >
//#define fpSHFormatDrive                stdcall_args< unsigned long , SHELL32 ,0xB9B8ED76 >
//#define fpSHFree               stdcall_args< void , SHELL32 ,0x88DCB079 >
//#define fpSHFreeNameMappings           stdcall_args< void , SHELL32 ,0xEF3161C9 >
//#define fpSHGetAttributesFromDataObject                stdcall_args< long , SHELL32 ,0x033C1BA4 >
//#define fpSHGetDataFromIDListA                 stdcall_args< long , SHELL32 ,0x8E4E0EBD >
//#define fpSHGetDataFromIDListW                 stdcall_args< long , SHELL32 ,0x8E4E0EAB >
//#define fpSHGetDesktopFolder           stdcall_args< long , SHELL32 ,0x84C2C3A6 >
//#define fpSHGetDiskFreeSpaceExA                stdcall_args< int , SHELL32 ,0xB55FD34B >
//#define fpSHGetDiskFreeSpaceExW                stdcall_args< int , SHELL32 ,0xB55FD35D >
//#define fpSHGetDriveMedia              stdcall_args< long , SHELL32 ,0xEA1653A1 >
//#define fpSHGetFileInfoA               stdcall_args< unsigned long , SHELL32 ,0x4782FD95 >
//#define fpSHGetFileInfoW               stdcall_args< unsigned long , SHELL32 ,0x4782FD83 >
//#define fpSHGetFolderLocation                  stdcall_args< long , SHELL32 ,0x3EB99A04 >
//#define fpSHGetFolderPathA             stdcall_args< long , SHELL32 ,0xDEAA9541 >
//#define fpSHGetFolderPathAndSubDirA            stdcall_args< long , SHELL32 ,0xA9067C4F >
//#define fpSHGetFolderPathAndSubDirW            stdcall_args< long , SHELL32 ,0xA9067C59 >
//#define fpSHGetFolderPathW             stdcall_args< long , SHELL32 ,0xDEAA9557 >
//#define fpSHGetIDListFromObject                stdcall_args< long , SHELL32 ,0xCBE910AA >
//#define fpSHGetIconOverlayIndexA               stdcall_args< int , SHELL32 ,0x8C710C30 >
//#define fpSHGetIconOverlayIndexW               stdcall_args< int , SHELL32 ,0x8C710C26 >
//#define fpSHGetImageList               stdcall_args< long , SHELL32 ,0x8CC907B2 >
//#define fpSHGetInstanceExplorer                stdcall_args< long , SHELL32 ,0x45CAC06F >
//#define fpSHGetItemFromDataObject              stdcall_args< long , SHELL32 ,0x112DBBE2 >
//#define fpSHGetItemFromObject                  stdcall_args< long , SHELL32 ,0xF48DB72F >
//#define fpSHGetKnownFolderIDList               stdcall_args< long , SHELL32 ,0xEB6E3D08 >
//#define fpSHGetKnownFolderItem                 stdcall_args< long , SHELL32 ,0x13FFB93C >
#define fpSHGetKnownFolderPath                 stdcall_args< long , SHELL32 ,0x10DAF1B9 >
//#define fpSHGetLocalizedName           stdcall_args< long , SHELL32 ,0x280EEAAC >
//#define fpSHGetMalloc                  stdcall_args< long , SHELL32 ,0x5A50F169 >
//#define fpSHGetNameFromIDList                  stdcall_args< long , SHELL32 ,0xA91FBD1D >
//#define fpSHGetNewLinkInfoA            stdcall_args< int , SHELL32 ,0x7E1044F9 >
//#define fpSHGetNewLinkInfoW            stdcall_args< int , SHELL32 ,0x7E1044EF >
//#define fpSHGetPathFromIDListA                 stdcall_args< int , SHELL32 ,0x8E4F2EED >
//#define fpSHGetPathFromIDListEx                stdcall_args< int , SHELL32 ,0x279774BF >
//#define fpSHGetPathFromIDListW                 stdcall_args< int , SHELL32 ,0x8E4F2EFB >
//#define fpSHGetPropertyStoreForWindow                  stdcall_args< long , SHELL32 ,0x30DA822A >
//#define fpSHGetPropertyStoreFromIDList                 stdcall_args< long , SHELL32 ,0xD57A7E6E >
//#define fpSHGetPropertyStoreFromParsingName            stdcall_args< long , SHELL32 ,0x6C3FEB17 >
//#define fpSHGetRealIDL                 stdcall_args< long , SHELL32 ,0xF8715B41 >
//#define fpSHGetSetFolderCustomSettings                 stdcall_args< long , SHELL32 ,0x74AA3F91 >
//#define fpSHGetSetSettings             stdcall_args< void , SHELL32 ,0x87C21784 >
//#define fpSHGetSettings                stdcall_args< void , SHELL32 ,0xBCA535A6 >
//#define fpSHGetSpecialFolderLocation           stdcall_args< long , SHELL32 ,0x3C9B64E6 >
//#define fpSHGetSpecialFolderPathA              stdcall_args< int , SHELL32 ,0xC95D8550 >
//#define fpSHGetSpecialFolderPathW              stdcall_args< int , SHELL32 ,0xC95D8546 >
//#define fpSHGetStockIconInfo           stdcall_args< long , SHELL32 ,0x8E5E2877 >
//#define fpSHGetTemporaryPropertyForItem                stdcall_args< long , SHELL32 ,0xFD5F3FC4 >
//#define fpSHGetUnreadMailCountW                stdcall_args< long , SHELL32 ,0x7BC5A3C5 >
//#define fpSHHandleUpdateImage                  stdcall_args< int , SHELL32 ,0x3BFFD61E >
//#define fpSHILCreateFromPath           stdcall_args< long , SHELL32 ,0x89719A5E >
//#define fpSHInvokePrinterCommandA              stdcall_args< int , SHELL32 ,0x418E8682 >
//#define fpSHInvokePrinterCommandW              stdcall_args< int , SHELL32 ,0x418E8694 >
//#define fpSHIsFileAvailableOffline             stdcall_args< long , SHELL32 ,0x5BE66B84 >
//#define fpSHLimitInputEdit             stdcall_args< long , SHELL32 ,0x67F9EA03 >
//#define fpSHLoadInProc                 stdcall_args< long , SHELL32 ,0x85D5578B >
//#define fpSHLoadNonloadedIconOverlayIdentifiers                stdcall_args< long , SHELL32 ,0x309BC3BD >
//#define fpSHMapPIDLToSystemImageListIndex              stdcall_args< int , SHELL32 ,0x69E2F833 >
//#define fpSHMultiFileProperties                stdcall_args< long , SHELL32 ,0x1031F801 >
//#define fpSHObjectProperties           stdcall_args< int , SHELL32 ,0x23D1537F >
//#define fpSHOpenFolderAndSelectItems           stdcall_args< long , SHELL32 ,0x49DD862B >
//#define fpSHOpenPropSheetW             stdcall_args< int , SHELL32 ,0x816AA443 >
//#define fpSHOpenWithDialog             stdcall_args< long , SHELL32 ,0x0ADE8948 >
//#define fpSHParseDisplayName           stdcall_args< long , SHELL32 ,0xD4CDD559 >
//#define fpSHPathPrepareForWriteA               stdcall_args< long , SHELL32 ,0xBC1AEF1F >
//#define fpSHPathPrepareForWriteW               stdcall_args< long , SHELL32 ,0xBC1AEF09 >
//#define fpSHPropStgCreate              stdcall_args< long , SHELL32 ,0x3A5FBECC >
//#define fpSHPropStgReadMultiple                stdcall_args< long , SHELL32 ,0x36B76029 >
//#define fpSHPropStgWriteMultiple               stdcall_args< long , SHELL32 ,0xA0B596B7 >
//#define fpSHQueryRecycleBinA           stdcall_args< long , SHELL32 ,0xBD4E6F42 >
//#define fpSHQueryRecycleBinW           stdcall_args< long , SHELL32 ,0xBD4E6F54 >
//#define fpSHQueryUserNotificationState                 stdcall_args< long , SHELL32 ,0x448D898B >
//#define fpSHRemoveLocalizedName                stdcall_args< long , SHELL32 ,0x3B2E83F4 >
//#define fpSHReplaceFromPropSheetExtArray               stdcall_args< unsigned int , SHELL32 ,0x4F6C3182 >
//#define fpSHResolveLibrary             stdcall_args< long , SHELL32 ,0xCECD96E3 >
//#define fpSHRestricted                 stdcall_args< unsigned long , SHELL32 ,0xF990935B >
//#define fpSHSetDefaultProperties               stdcall_args< long , SHELL32 ,0x2BC06D16 >
//#define fpSHSetFolderPathA             stdcall_args< long , SHELL32 ,0x7EAA9541 >
//#define fpSHSetFolderPathW             stdcall_args< long , SHELL32 ,0x7EAA9557 >
//#define fpSHSetInstanceExplorer                stdcall_args< void , SHELL32 ,0x45CAC06A >
//#define fpSHSetKnownFolderPath                 stdcall_args< long , SHELL32 ,0x1ADAF1B9 >
//#define fpSHSetLocalizedName           stdcall_args< long , SHELL32 ,0x280EC2AC >
//#define fpSHSetTemporaryPropertyForItem                stdcall_args< long , SHELL32 ,0xF85F3FC4 >
//#define fpSHSetUnreadMailCountW                stdcall_args< long , SHELL32 ,0x7BC5A3C0 >
//#define fpSHShellFolderView_Message            stdcall_args< long , SHELL32 ,0x8AC44921 >
//#define fpSHShowManageLibraryUI                stdcall_args< long , SHELL32 ,0x280B0E8E >
//#define fpSHSimpleIDListFromPath               stdcall_args< struct , SHELL32 ,0x16B07883 >
//#define fpSHStartNetConnectionDialogW                  stdcall_args< long , SHELL32 ,0x6D2A5826 >
//#define fpSHTestTokenMembership                stdcall_args< int , SHELL32 ,0x87EBD43F >
//#define fpSHUpdateImageA               stdcall_args< void , SHELL32 ,0x215AD8BF >
//#define fpSHUpdateImageW               stdcall_args< void , SHELL32 ,0x215AD8A9 >
//#define fpSHValidateUNC                stdcall_args< int , SHELL32 ,0xA55FE1FC >
//#define fpSetCurrentProcessExplicitAppUserModelID              stdcall_args< long , SHELL32 ,0x84AA2DBE >
//#define fpShellAboutA                  stdcall_args< int , SHELL32 ,0x4824DCBB >
//#define fpShellAboutW                  stdcall_args< int , SHELL32 ,0x4824DCAD >
//#define fpShellExecuteA                stdcall_args< struct HINSTANCE, SHELL32 ,0x570BC899 >
//#define fpShellExecuteExA              stdcall_args< int , SHELL32 ,0xF2276983 >
//#define fpShellExecuteExW              stdcall_args< int , SHELL32 ,0xF2276995 >
//#define fpShellExecuteW                stdcall_args< struct HINSTANCE, SHELL32 ,0x570BC88F >
//#define fpShellMessageBoxA             stdcall_args< int , SHELL32 ,0x85714FAE >
//#define fpShellMessageBoxW             stdcall_args< int , SHELL32 ,0x85714FB8 >
//#define fpShell_GetCachedImageIndexA           stdcall_args< int , SHELL32 ,0x8205ABC4 >
//#define fpShell_GetCachedImageIndexW           stdcall_args< int , SHELL32 ,0x8205ABD2 >
//#define fpShell_GetImageLists                  stdcall_args< int , SHELL32 ,0x28E601DD >
//#define fpShell_MergeMenus             stdcall_args< unsigned int , SHELL32 ,0x1793159A >
//#define fpShell_NotifyIconA            stdcall_args< int , SHELL32 ,0x0E304EAD >
//#define fpShell_NotifyIconGetRect              stdcall_args< long , SHELL32 ,0x8B63DEE3 >
//#define fpShell_NotifyIconW            stdcall_args< int , SHELL32 ,0x0E304EBB >
//#define fpSignalFileOpen               stdcall_args< int , SHELL32 ,0x2BED6E3A >
//#define fpStgMakeUniqueName            stdcall_args< long , SHELL32 ,0xD94521BF >
